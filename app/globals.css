@import "tailwindcss";

/* include utility classes in streamdown */
@source '../node_modules/streamdown/dist/index.js';

/* custom variant for setting dark mode programmatically */
@custom-variant dark (&:is(.dark, .dark *));

/* include plugins */
@plugin "tailwindcss-animate";
@plugin "@tailwindcss/typography";

/* define design tokens (light mode) - Grok-inspired */
:root {
  --background: hsl(0 0% 98%); /* Very light gray */
  --foreground: hsl(0 0% 10%); /* Almost black for text */
  --card: hsl(0 0% 100%);
  --card-foreground: hsl(0 0% 10%);
  --popover: hsl(0 0% 100%);
  --popover-foreground: hsl(0 0% 10%);
  --primary: hsl(270 80% 60%); /* Vibrant purple */
  --primary-foreground: hsl(0 0% 100%);
  --secondary: hsl(240 10% 96%);
  --secondary-foreground: hsl(0 0% 10%);
  --muted: hsl(240 5% 96%);
  --muted-foreground: hsl(240 4% 46%);
  --accent: hsl(270 80% 60%);
  --accent-foreground: hsl(0 0% 100%);
  --destructive: hsl(0 84.2% 60.2%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(240 6% 90%);
  --input: hsl(240 6% 90%);
  --ring: hsl(270 80% 60%);
  --chart-1: hsl(270 80% 60%);
  --chart-2: hsl(210 80% 60%);
  --chart-3: hsl(330 80% 60%);
  --chart-4: hsl(180 80% 60%);
  --chart-5: hsl(30 80% 60%);
  --sidebar-background: hsl(0 0% 100%);
  --sidebar-foreground: hsl(0 0% 10%);
  --sidebar-primary: hsl(270 80% 60%);
  --sidebar-primary-foreground: hsl(0 0% 100%);
  --sidebar-accent: hsl(240 5% 96%);
  --sidebar-accent-foreground: hsl(0 0% 10%);
  --sidebar-border: hsl(240 6% 90%);
  --sidebar-ring: hsl(270 80% 60%);
  /* border radius unit - more rounded for premium feel */
  --radius: 1rem;
  --sidebar: hsl(0 0% 100%);
}

/* define design tokens (dark mode) - Grok-inspired deep black theme */
.dark {
  --background: hsl(0 0% 4%); /* Deep black like Grok */
  --foreground: hsl(0 0% 95%); /* Bright white text */
  --card: hsl(0 0% 8%);
  --card-foreground: hsl(0 0% 95%);
  --popover: hsl(0 0% 8%);
  --popover-foreground: hsl(0 0% 95%);
  --primary: hsl(270 80% 65%); /* Vibrant purple accent */
  --primary-foreground: hsl(0 0% 100%);
  --secondary: hsl(0 0% 12%);
  --secondary-foreground: hsl(0 0% 95%);
  --muted: hsl(0 0% 12%);
  --muted-foreground: hsl(0 0% 60%);
  --accent: hsl(270 80% 65%);
  --accent-foreground: hsl(0 0% 100%);
  --destructive: hsl(0 84.2% 60.2%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(0 0% 16%); /* Subtle borders */
  --input: hsl(0 0% 16%);
  --ring: hsl(270 80% 65%);
  --chart-1: hsl(270 80% 65%);
  --chart-2: hsl(210 80% 65%);
  --chart-3: hsl(330 80% 65%);
  --chart-4: hsl(180 80% 65%);
  --chart-5: hsl(30 80% 65%);
  --sidebar-background: hsl(0 0% 6%); /* Slightly lighter than main bg */
  --sidebar-foreground: hsl(0 0% 95%);
  --sidebar-primary: hsl(270 80% 65%);
  --sidebar-primary-foreground: hsl(0 0% 100%);
  --sidebar-accent: hsl(0 0% 12%);
  --sidebar-accent-foreground: hsl(0 0% 95%);
  --sidebar-border: hsl(0 0% 16%);
  --sidebar-ring: hsl(270 80% 65%);
  --sidebar: hsl(0 0% 6%);
}

/* define theme */
@theme {
  --font-sans: var(--font-geist);
  --font-mono: var(--font-geist-mono);

  --breakpoint-toast-mobile: 600px;

  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);

  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);

  --color-sidebar: var(--sidebar-background);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

/*
  The default border color has changed to `currentcolor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }
}

@utility text-balance {
  text-wrap: balance;
}

@utility -webkit-overflow-scrolling-touch {
  -webkit-overflow-scrolling: touch;
}

@utility touch-pan-y {
  touch-action: pan-y;
}

@utility overscroll-behavior-contain {
  overscroll-behavior: contain;
}

@layer utilities {
  :root {
    --foreground-rgb: 0, 0, 0;
    --background-start-rgb: 214, 219, 220;
    --background-end-rgb: 255, 255, 255;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --foreground-rgb: 255, 255, 255;
      --background-start-rgb: 0, 0, 0;
      --background-end-rgb: 0, 0, 0;
    }
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    overflow-x: hidden;
    position: relative;
    font-feature-settings: "cv11", "ss01";
    font-optical-sizing: auto;
  }

  html {
    overflow-x: hidden;
  }

  /* Mobile input optimization */
  @media (max-width: 768px) {
    textarea {
      word-wrap: break-word;
      overflow-wrap: break-word;
      white-space: pre-wrap;
    }
  }
  
  /* Grok-style smooth scrolling */
  * {
    scroll-behavior: smooth;
  }
}

/* Claude-style Artifact Enhancements */
.artifact-container {
  @apply space-y-4;
}

.artifact-section {
  @apply rounded-lg border border-border bg-background p-4 shadow-sm transition-all hover:shadow-md;
}

.artifact-section-header {
  @apply mb-3 flex items-center gap-2 text-lg font-semibold;
}

.artifact-code-block {
  @apply rounded-lg border border-border bg-muted/50 p-4 font-mono text-sm;
}

.artifact-visual-box {
  @apply rounded-lg border-2 border-primary/20 bg-primary/5 p-6;
}

.artifact-callout {
  @apply rounded-lg border-l-4 border-primary bg-primary/10 p-4 dark:bg-primary/20;
}

.artifact-callout-info {
  @apply border-blue-500 bg-blue-50 dark:bg-blue-950/30;
}

.artifact-callout-warning {
  @apply border-yellow-500 bg-yellow-50 dark:bg-yellow-950/30;
}

.artifact-callout-success {
  @apply border-green-500 bg-green-50 dark:bg-green-950/30;
}

.artifact-callout-error {
  @apply border-red-500 bg-red-50 dark:bg-red-950/30;
}

.artifact-diagram-container {
  @apply my-6 rounded-lg border border-border bg-background p-6 shadow-sm;
}

.artifact-table {
  @apply w-full border-collapse rounded-lg border border-border;
}

.artifact-table th {
  @apply border-b border-border bg-muted/50 px-4 py-2 text-left font-semibold;
}

.artifact-table td {
  @apply border-b border-border px-4 py-2;
}

.artifact-quiz-box {
  @apply rounded-lg border-2 border-purple-500/30 bg-purple-50 p-4 dark:bg-purple-950/20;
}

.artifact-example-box {
  @apply rounded-lg border-2 border-green-500/30 bg-green-50 p-4 dark:bg-green-950/20;
}

.artifact-key-point {
  @apply my-2 flex items-start gap-3 rounded-lg bg-muted/30 p-3;
}

/* Mermaid diagram styling */
.mermaid-container {
  @apply my-6 overflow-x-auto rounded-lg border border-border bg-background p-6 shadow-sm;
}

.mermaid-container svg {
  @apply mx-auto max-w-full;
}

.skeleton {
  * {
    pointer-events: none !important;
  }

  *[class^="text-"] {
    color: transparent;
    @apply rounded-md bg-foreground/20 select-none animate-pulse;
  }

  .skeleton-bg {
    @apply bg-foreground/10;
  }

  .skeleton-div {
    @apply bg-foreground/20 animate-pulse;
  }
}

.ProseMirror {
  outline: none;
}

.cm-editor,
.cm-gutters {
  @apply bg-background! dark:bg-zinc-800! outline-hidden! selection:bg-zinc-900!;
}

.ͼo.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground,
.ͼo.cm-selectionBackground,
.ͼo.cm-content::selection {
  @apply bg-zinc-200! dark:bg-zinc-900!;
}

.cm-activeLine,
.cm-activeLineGutter {
  @apply bg-transparent!;
}

.cm-activeLine {
  @apply rounded-r-sm!;
}

.cm-lineNumbers {
  @apply min-w-7;
}

.cm-foldGutter {
  @apply min-w-3;
}

.cm-lineNumbers .cm-activeLineGutter {
  @apply rounded-l-sm!;
}

.suggestion-highlight {
  @apply bg-blue-200 hover:bg-blue-300 dark:hover:bg-blue-400/50 dark:text-blue-50 dark:bg-blue-500/40;
}

/* Grok-style minimal scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: hsl(0 0% 20%);
  border-radius: 10px;
  transition: background 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(0 0% 30%);
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: hsl(0 0% 20%) transparent;
}

/* Grok-style glassmorphism utilities */
.glass-effect {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.dark .glass-effect {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.05);
}

/* Premium gradient text */
.gradient-text {
  background: linear-gradient(135deg, hsl(270 80% 65%), hsl(210 80% 65%), hsl(330 80% 65%));
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

@theme inline {
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Ensure sidebar visibility and prevent layout issues */
[data-sidebar="sidebar"] {
  min-width: var(--sidebar-width-icon);
  background: hsl(var(--sidebar));
  border-right: 1px solid hsl(var(--sidebar-border));
}

/* Ensure proper sidebar state handling */
.group\/sidebar-wrapper:has([data-state="expanded"]) [data-sidebar="sidebar"] {
  width: var(--sidebar-width);
}

.group\/sidebar-wrapper:has([data-state="collapsed"]) [data-sidebar="sidebar"] {
  width: var(--sidebar-width-icon);
}

/* Fix for mobile sidebar */
@media (max-width: 768px) {
  [data-mobile="true"][data-sidebar="sidebar"] {
    width: var(--sidebar-width-mobile) !important;
  }
}
